"use strict";var lc=lc||{};lc.Cache={enable:!0,files:{},add:function(e,t){var n=this,r=!1;return!1!==n.enable&&(n.files[e]=t,r=!0),r},get:function(e){return this.files[e]}};var lc=lc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};!function(){var e=/\b_super\b/;lc.Class=function(){},lc.Class.extend=function(t){function n(){this.__instanceId=ClassManager.getNewInstanceId(),this.ctor&&this.ctor.apply(this,arguments)}var r=this.prototype,o=Object.create(r),i=ClassManager.getNewID();ClassManager[i]=r;var a={writable:!0,enumerable:!1,configurable:!0};o.__instanceId=null,n.id=i,a.value=i,Object.defineProperty(o,"__pid",a),n.prototype=o,a.value=n,Object.defineProperty(n.prototype,"constructor",a),this.__getters__&&(n.__getters__=lc.clone(this.__getters__)),this.__setters__&&(n.__setters__=lc.clone(this.__setters__));for(var s=0,c=arguments.length;s<c;++s){var l=arguments[s];for(var u in l){var d="function"==typeof l[u],f="function"==typeof r[u],p=e.test(l[u]);if(d&&f&&p?(a.value=function(e,t){return function(){var n=this._super;this._super=r[e];var o=t.apply(this,arguments);return this._super=n,o}}(u,l[u]),Object.defineProperty(o,u,a)):d?(a.value=l[u],Object.defineProperty(o,u,a)):o[u]=l[u],d){var h,g,v;if(this.__getters__&&this.__getters__[u]){v=this.__getters__[u];for(var _ in this.__setters__)if(this.__setters__[_]===v){g=_;break}lc.defineGetterSetter(o,v,l[u],l[g]?l[g]:o[g],u,g)}if(this.__setters__&&this.__setters__[u]){v=this.__setters__[u];for(var _ in this.__getters__)if(this.__getters__[_]===v){h=_;break}lc.defineGetterSetter(o,v,l[h]?l[h]:o[h],l[u],h,u)}}}}return n.extend=lc.Class.extend,n.implement=function(e){for(var t in e)o[t]=e[t]},n}}(),lc.defineGetterSetter=function(e,t,n,r,o,i){if(e.__defineGetter__)n&&e.__defineGetter__(t,n),r&&e.__defineSetter__(t,r);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var a={enumerable:!1,configurable:!0};n&&(a.get=n),r&&(a.set=r),Object.defineProperty(e,t,a)}if(!o&&!i)for(var s=null!=n,c=void 0!=r,l=Object.getOwnPropertyNames(e),u=0;u<l.length;u++){var d=l[u];if((e.__lookupGetter__?!e.__lookupGetter__(d):!Object.getOwnPropertyDescriptor(e,d))&&"function"==typeof e[d]){var f=e[d];if(s&&f===n&&(o=d,!c||i))break;if(c&&f===r&&(i=d,!s||o))break}}var p=e.constructor;o&&(p.__getters__||(p.__getters__={}),p.__getters__[o]=t),i&&(p.__setters__||(p.__setters__={}),p.__setters__[i]=t)},lc.clone=function(e){var t=e.constructor?new e.constructor:{};for(var n in e){var r=e[n];"object"!=typeof r||!r||r instanceof HTMLElement?t[n]=r:t[n]=lc.clone(r)}return t},lc.inject=function(e,t){for(var n in e)t[n]=e[n]};var lc=lc||{};lc.Core={launch:function(e,t,n){lc.EngineStart(e,t,n,function(){var e=lc.Project.getProjectData(),t=e.ResourceText.projectSetting.defaultSceneID,n=lc.Project.getResourceBySceneId(t);lc.Loader.load(n,function(){console.log("load finished");var n=[{type:"script",url:APIRoot+"gf/sdk/GenJs?userid="+USERID+"&projectid="+PROJECTID+"&isglobal=1"}];lc.Loader.load(n,function(){var n=[{type:"script",url:APIRoot+"gf/sdk/GenTpl/"+e.FrameworkVersion+"/2d/RenderScene?userid="+USERID+"&projectid="+PROJECTID+"&sceneid="+t}];lc.Loader.load(n,function(){console.log("load render scene finished.")})})})})}};var lc=lc||{};lc.LoaderBase=lc.Class.extend({times:5,ctor:function(){},load:function(e,t,n){var r=this,o=lc.Cache.get(e);if(o)return t&&t(cached),o;r.tryLoad(e,t,n,0)},tryLoad:function(e,t,n,r){}}),lc.ImageLoader=lc.LoaderBase.extend({ctor:function(){this._super()},tryLoad:function(e,t,n,r){var o=this,i=new Image;i.addEventListener("load",function(){lc.Cache.add(e,this),t&&t(this)},!1),i.addEventListener("error",function(){r<o.times?o.tryLoad(e,t,n,r++):n&&n(event)},!1),i.src=e}}),lc.imageLoaderInstance=new lc.ImageLoader,lc.ScriptLoader=lc.LoaderBase.extend({ctor:function(){this._super()},tryLoad:function(e,t,n,r){var o=this,i=document.createElement("script"),a=null,s=null;i.async=!1,a=function(){lc.Cache.add(e,!0),t&&t(this),i.parentNode&&i.parentNode.removeChild(i),i.removeEventListener("load",a,!1),i.removeEventListener("error",s,!1)},s=function(){i.parentNode&&i.parentNode.removeChild(i),i.removeEventListener("load",a,!1),i.removeEventListener("error",s,!1),r<o.times?o.tryLoad(e,t,n,r++):n&&n(event)},i.addEventListener("load",a,!1),i.addEventListener("error",s,!1),i.src=e,document.body.appendChild(i)}}),lc.scriptLoaderInstance=new lc.ScriptLoader,lc.audioLoader=lc.LoaderBase.extend({ctor:function(){this._super()},tryLoad:function(e,t,n,r){var o=null,i=Audio?new Audio(""):document.createElement("audio"),a=function(){o&&window.clearTimeout(o),lc.Cache.add(e,!0),t&&t(this),c()},s=function(){n&&n(event),c()},c=function(){i.removeEventListener("loadedmetadata",a,!1),i.removeEventListener("error",s,!1)};o=setTimeout(function(){console.log("load:"+e+" time out."),n&&n(event),c()},3e4),i.addEventListener("loadedmetadata",a,!1),i.addEventListener("error",s,!1),i.src=e}}),lc.audioLoaderInstance=new lc.audioLoader,lc.Loader={loaders:{image:lc.imageLoaderInstance,script:lc.scriptLoaderInstance,audio:lc.audioLoaderInstance},load:function(e,t){for(var n=this,r=0,o=function(n){++r>=e.length&&t&&t()},i=function(n){n&&console.log(n),++r>=e.length&&t&&t()},a=0;a<e.length;a++){var s=e[a],c=n.loaders[s.type];c&&c.load(s.url,o,i)}}};var lc=lc||{};lc.Object=lc.Class.extend({oComponents:null,oParent:null,aChildren:null,sTag:null,oEngineObject:null,oSize:null,oAnchor:null,oScale:null,oPosition:null,nRotation:null,oSkew:null,nAlpha:null,bVisible:!0,oFlip:null,aTweens:null,aSchedules:null,ctor:function(){var e=this;e.oComponents={},e.oEngineObject=new lc.EngineObject,e.aChildren=[],e.aTweens=[],e.aSchedules=[],e.oSize={width:0,height:0},e.oAnchor={x:0,y:0},e.oScale={x:0,y:0},e.oPosition={x:0,y:0,z:0},e.nRotation=0,e.oFlip={x:!1,y:!1},e.oSkew={x:0,y:0}},setSize:function(e,t){var n=this;n.oSize={width:+e||n.oSize.width,height:+t||n.oSize.height}},getSize:function(){return this.oSize},setAnchor:function(e,t){var n=this;n.oAnchor={x:+e||n.oAnchor.x,y:+t||n.oAnchor.y}},getAnchor:function(){return this.oAnchor},setScale:function(e,t){var n=this;n.oScale={x:+e||n.oScale.x,y:+t||n.oScale.y}},getScale:function(){return this.oScale},setPosition:function(e,t,n){var r=this;r.oPosition={x:+e||r.oPosition.x,y:+t||r.oPosition.y,z:+n||r.oPosition.z}},getPosition:function(){return this.oPosition},setRotation:function(e){var t=this;t.nRotation=+x||t.nRotation},getRotation:function(){return this.nRotation},setSkew:function(e,t){var n=this;n.oSkew={x:+e||n.oSkew.x,y:+t||n.oSkew.y}},getSkew:function(){return this.oSkew},setAlpha:function(e){var t=this;t.nAlpha=+e||t.nAlpha},getAlpha:function(){return this.nAlpha},setFlipX:function(e){this.oFlip.x=e},getFilpX:function(){return this.oFlip.x},setFlipY:function(e){this.oFlip.y=e},getFlipY:function(){return this.oFlip.y},setVisible:function(e){this.bVisible=e},getVisible:function(){return this.bVisible},setZOrder:function(e){this.oPosition.z=e},getZOrder:function(){return this.oPosition.z},addComponet:function(e,t){var n=this;n.oComponents[e]||(n.oComponents[e]=[]),n.oComponents[e].push(t),t.gameObject=n},removeComponent:function(e){var t=this;for(var n in t.oComponents)if(t.oComponents[n])for(var r=0,o=t.oComponents[n].length;r<o;r++)if(t.oComponents[n][r]&&t.oComponents[n][r]===e){t.oComponents[n].splice(r,1),0===t.oComponents[n].length&&delete t.oComponents[n],e.gameObject=null;break}},removeAllComponents:function(){var e=this;for(var t in e.oComponents)if(e.oComponents[t]){for(var n=0;n<e.oComponents[t].length;n++)e.oComponents[t][n]&&e.oComponents[t][n].clear();e.oComponents[t].length=0}e.components={}},removeComponents:function(e){var t=this;if(t.oComponents[e]){for(var n=0;n<t.oComponents[e].length;n++)t.oComponents[e]&&t.oComponents[e].splice(n,1);delete t.oComponents[e]}},getComponents:function(e){return this.oComponents[e]||[]},getAllComponents:function(){return this.oComponents},setTag:function(e){this.sTag=e},setName:function(e){this.sName=e},addChild:function(e){var t=this;t.aChildren.push(e),e.oParent=t},removeChildren:function(){for(var e=this,t=e.aChildren.length,n=0;n<t;n++)e.aChildren[n]&&e.aChildren[n].clear();e.aChildren.length=0},removeChildByTag:function(e,t){var n=this;t=void 0===t;for(var r=n.aChildren.length,o=0;o<r;o++){var i=n.aChildren[o];if(i&&i.sTag===e){t?i.clear():i.engineObject.removeChild(cleanup),n.aChildren.splice(o,1);break}}},removeFromParent:function(e){var t=this;if(e=void 0===e,t.oParent)for(var n=t.oParent.aChildren.length,r=0;r<n;r++){var o=t.oParent.aChildren[r];if(o&&o.sTag===t.sTag){e?t.clear():o.engineObject.removeChild(cleanup),t.oParent.aChildren.splice(r,1);break}}},addTween:function(e){this.aTweens.push(e)},delTween:function(e){var t=this;if(e){var n=t.aTweens.indexOf(e);-1!==n&&(e.stop(),t.aTweens.splice(n,1))}},delTweens:function(){for(var e=this,t=e.aTweens.length,n=0;n<t;n++)e.delTween(e.aTweens[n]);e.aTweens.length=0},addSchedule:function(e){this.aSchedules.push(e)}});var lc=lc||{};lc.Project={_projectData:null,_resource:null,prepare:function(e){var t=this,n=lc.Util.getXMLHttpRequest(),r=null;r="pid=fe1bf410-2965-11e7-ab3f-cba729ac7ef0",n.open("POST","http://10.57.220.76:12000/op//gf/webapi/ReadProject_Preview"),n.setRequestHeader("Content-Type","application/x-www-form-urlencodeed;charset=UTF-8");n.onreadystatechange=function(){if(4==n.readyState&&(200==n.status||0==n.status)){var r=n.responseText||'{"state":"ok","projectinfo":{"name":"userInterface","owner":"24289509306817014","ProjectText":{"version":0.91,"editorVersion":2,"owner":"24289509306817014","users":[],"project":"","name":"userInterface","ptype":0,"structure":{"sences":{},"objects":{}},"packages":{"base":["Base"],"extra":[]}},"ResourceText":{"version":0.91,"curranimationId":200000,"currresId":300002,"currprototypeId":400000,"currlogicId":500002,"currsceneId":600000,"currScene":600000,"currmapId":700000,"currparticleId":800000,"currvariableId":1000000,"currloadingId":2000000,"wraperId":0,"owner":"24289509306817014","project":"","name":"userInterface","resolution":{"adapterMode":"2","width":"640","height":"1136"},"logicPlugin":[],"structure":{"currentTabs":[{"id":"page1","path":"/素材","title":"素材","state":true},{"id":"page2","path":"/动画","title":"动画","state":true},{"id":"page3","path":"/逻辑","title":"逻辑","state":true},{"id":"page4","path":"/原型","title":"原型","state":true},{"id":"page5","path":"/场景","title":"场景","state":true},{"id":"page6","path":"/地图","title":"地图","state":true},{"id":"page7","path":"/数据","title":"数据","state":true}],"resources":{"/":{"d":["素材","动画","逻辑","原型","场景","地图","数据"],"f":[]},"/素材":{"d":["图片","影音","数据"],"f":[]},"/素材/图片":{"d":[],"f":[300001]},"/素材/影音":{"d":[],"f":[300002]},"/素材/数据":{"d":[],"f":[]},"/动画":{"d":[],"f":[]},"/逻辑":{"d":[],"f":[500001,500002]},"/原型":{"d":[],"f":[]},"/场景":{"d":[],"f":["600000"]},"/地图":{"d":[],"f":[]},"/数据":{"d":[],"f":[]}}},"origin":{"resources":{"300001":{"resType":"image","resURL":"/images/e86307d2be74cffb5e565f2867be4502.png","size":11264,"width":357,"height":103},"300002":{"resType":"audio","resURL":"/material/sounds/4/a38508d01e41ac879180c2e44e64013d.mp3","size":322560,"width":0,"height":0},"500001":{"resType":"logic","data":{"data":[[{"argu":["2","200000","360",false],"block":[[]],"pos":{"left":78,"top":158},"type":"ac-runRotates","resources":[]},{"argu":["1",100000,"2",false],"block":[[{"argu":["1","200000","1",false],"block":[[]],"pos":{},"type":"ac-runScales","resources":[]}]],"pos":{"left":78,"top":158},"type":"ac-runScales","resources":[]}]],"local":[]},"md5":"7ae23c1ebdbd58530791b95a9ae06def"},"500002":{"resType":"logic","data":{"data":[[{"argu":["2","320","850",null],"block":[[]],"pos":{"left":46,"top":240},"type":"ac-runEaseInOutMoving","resources":[]}]],"local":[]},"md5":"5def5d700efbaf590ef0a929cf02f61d"},"600000":{"resType":"scene","data":{"gameSetting":[{"id":"b00f220b-89e7-4254-be90-2bc639956574","child":[]},{"id":"133b2e5f-d990-446d-a75d-60cf55114d37","child":[]}],"instance":{"b00f220b-89e7-4254-be90-2bc639956574":{"components":{"Transform":[{"propertys":{"objectName":"Logo","transform":{"Position":{"x":"320.00","y":"568.00","z":"0.00"},"Scale":{"x":"1.00","y":"1.00"},"Rotation":{"x":"0.00","y":0}},"alpha":100,"group":"默认"},"id":1,"enabled":true}],"Texture":[{"propertys":{"file":{"id":"300001","name":"logo.png"},"blendFunc":0},"id":2,"enabled":true}],"Event":[{"propertys":{"EventType":0,"file":{"name":"逻辑2","id":"500002"}},"id":3,"enabled":true}]},"wraperName":"Logo","lockState":0,"resources":[{"number":1,"resId":"300001"},{"number":1,"resId":"500001"},{"number":1,"resId":"500002"}]},"133b2e5f-d990-446d-a75d-60cf55114d37":{"components":{"Transform":[{"propertys":{"objectName":"音频","transform":{"Position":{"x":"245.84","y":"210.01","z":"0.00"},"Scale":{"x":"1.00","y":"1.00"},"Rotation":{"x":"0.00","y":0}},"alpha":100,"group":"默认"},"id":1,"enabled":true}],"Audio":[{"propertys":{"src":{"id":"300002","name":"格式工厂游戏中背景音乐.mp3"},"playType":0,"Volume":100,"autoPlay":true,"isLoop":false},"id":2,"enabled":true}]},"wraperName":"音频","lockState":null,"resources":[{"number":1,"resId":"300002"}]}},"arInstance":{}}}}},"projectSetting":{"gameEngine":"crafty","defaultSceneID":"600000","resolution":{"adapterMode":"2","width":"640","height":"1136"},"id":"75067a90-2fe3-11e7-821f-d36a32f88b9c","owner":"24289509306817014"}},"FrameworkVersion":"2.1","Type":"1","version":{"oldVersion":0.91,"version":0.91}}}',o=JSON.parse(r);"ok"==o.state&&(t._projectData=o.projectinfo,t._resources=o.projectinfo.ResourceText.origin.resources),e&&e()}},n.send(r)},getProjectData:function(){return this._projectData},getResourceForKey:function(e){return this._resource[e]},getResourceInstance:function(e,t){var n=[];for(var r in t){var o=t[r];if(o.resources)for(var i=0;i<o.resources.length;i++){var a=o.resources[i].resId?o.resources[i].resId:o.resources[i],s=e[a];if(s)if("logic"===s.resType);else if("image"===s.resType)n.push({type:"image",url:ResRoot+s.resURL.substr(1)});else if("audio"===s.resType)n.push({type:"audio",url:ResRoot+s.resURL.substr(1)});else if("fnt"===s.resType)n.push({type:"fnt",url:ResRoot+s.resURL.substr(1)});else if("applciation"===s.resType)n.push({type:"application",url:ResRoot+s.resURL.substr(1)});else if("map"===s.resTYpe)for(var c=s.data.mapBlock,l=0;l<c.length;l++){var u=c[l];n.push({type:"image",url:ResRoot+u.src.substr(1)})}}}return n},getResourceBySceneId:function(e){var t=this,n=[],r=t._resources,o=r[e];if(o){var i=o.data.instance;n=t.getResourceInstance(r,i)}return n}};var lc=lc||{};lc.Scene=lc.Class.extend({objType:"scene",children:null,engineScene:null,ctor:function(){var e=this;e.children=[],e.engineScene=new lc.EngineScene},addChild:function(e){var t=this;if(null!==e.parent)throw new Error("child already have a parent!");e.parent=t,t.children.push(e),t.engineScene.addChild(e.engineObject)},_traverseObject:function(e,t){var n=this;if(e.tag=t)return e;if(e.children&&e.children[0])for(var r=0;r<e.length;r++){var o=n._traverseObject(e.children[r],key);if(o)return o}},getChildByTag:function(e){var t=this,n=t._traverseObject(t,e);return n=n||null},clear:function(e){for(var t=this,n=t.children.length,r=n-1;r>=0;r--)t.children[r]&&t.children[r].clear(!0);t.children.length=0,e&&t.engineScene.cleanup(),e=null},run:function(){_this.engineScene&&(_this.engineScene.run&&_this.engineScene.run(),console.log("scene run"))},update:function(){for(var e=this,t=e.children,n=t.length,r=null,o=n-1;o>=0;o--)(r=t[o])&&r.update()},onEvent:function(e){for(var t=this,n=t.children,r=n.length,o=null,i=r-1;i>=0&&(!(o=n[i])||!o.onEvent(e));i--);}});var lc=lc||{};lc.Util={getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},getObjectType:function(e){return Object.prototype.toString.call(e).slice(8,-1)}};